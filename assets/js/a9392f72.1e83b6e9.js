"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[111],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return d}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(t),d=a,h=m["".concat(l,".").concat(d)]||m[d]||u[d]||o;return t?r.createElement(h,i(i({ref:n},p),{},{components:t})):r.createElement(h,i({ref:n},p))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},8214:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return p},default:function(){return m}});var r=t(7462),a=t(3366),o=(t(7294),t(3905)),i=["components"],s={sidebar_position:10},l="Overview",c={unversionedId:"api/client-libraries/overview",id:"api/client-libraries/overview",isDocsHomePage:!1,title:"Overview",description:"The following Libraries are currently available:",source:"@site/docs/api-server/api/client-libraries/overview.mdx",sourceDirName:"api/client-libraries",slug:"/api/client-libraries/overview",permalink:"/docs/api-server/api/client-libraries/overview",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Pektin API Server",permalink:"/docs/api-server/overview"},next:{title:"JavaScript / TypeScript",permalink:"/docs/api-server/api/client-libraries/js-ts"}},p=[{value:"Basic Abstractions",id:"basic-abstractions",children:[{value:"Important Helper Functions",id:"important-helper-functions",children:[]},{value:"Get Endpoints from Pektin Config",id:"get-endpoints-from-pektin-config",children:[]},{value:"Get Value from Vault",id:"get-value-from-vault",children:[]}]}],u={toc:p};function m(e){var n=e.components,t=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"overview"},"Overview"),(0,o.kt)("p",null,"The following Libraries are currently available:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"./js-ts"},"JavaScript/TypeScript"))),(0,o.kt)("h1",{id:"create-your-own"},"Create your own"),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you want to or have created your own please contact us if you want to get it listed here."))),(0,o.kt)("h2",{id:"basic-abstractions"},"Basic Abstractions"),(0,o.kt)("p",null,"The Pektin setup may come along to your client in various configurations. To handle these without loosing your mind, this section will tell you more about some basic abstractions that are implemented in the reference client ",(0,o.kt)("a",{parentName:"p",href:"./js-ts"},"JavaScript/TypeScript")," and should be implemented by other clients as well."),(0,o.kt)("h3",{id:"important-helper-functions"},"Important Helper Functions"),(0,o.kt)("h4",{id:"absolutename"},"absoluteName"),(0,o.kt)("p",null,'In DNS most of the times "absolute domain names" are used.\nThis means they end in a dot.'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Absolute"),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"pektin.club.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Not Absolute"),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"pektin.club")),(0,o.kt)("p",null,"This function should always return a absolute name no matter the input."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export const absoluteName = (name: string) => {\n    if (typeof name !== `string`) return name;\n    if (name.endsWith(`.`)) {\n        return name;\n    }\n    return name + `.`;\n};\n")),(0,o.kt)("h4",{id:"deabsolute"},"deAbsolute"),(0,o.kt)("p",null,"Same as above but ensuring the name is ",(0,o.kt)("strong",{parentName:"p"},"NOT")," absolute"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export const deAbsolute = (name: string) => {\n    if (name.endsWith(`.`)) {\n        return name.substring(0, name.length - 1);\n    }\n    return name;\n};\n")),(0,o.kt)("h4",{id:"isabsolute"},"isAbsolute"),(0,o.kt)("p",null,"Simple function that checks if a name is absolute or not returning a boolean"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export const isAbsolute = (name: string): boolean => name.endsWith(`.`);\n")),(0,o.kt)("h4",{id:"concatdomain"},"concatDomain"),(0,o.kt)("p",null,"A function that takes a domain and subDomain and concats them.\nThis should correct for absolute or non absolute domain names."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export const concatDomain = (domain: string, subDomain?: string) => {\n    if (subDomain === undefined) return domain;\n    return `${deAbsolute(subDomain)}.${domain}`;\n};\n")),(0,o.kt)("h3",{id:"get-endpoints-from-pektin-config"},"Get Endpoints from Pektin Config"),(0,o.kt)("p",null,"The first argument takes a PektinConfig object."),(0,o.kt)("p",null,"The second argument takes the endpoint you want to get from the config file."),(0,o.kt)("p",null,"The third argument is an optional boolean that defaults to false. If it is set to true the internal container endpoints shall be used."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// get the pektin endpoints from the pektin config\nexport const getPektinEndpoint = (\n    c: PektinConfig,\n    endpointType: `api` | `vault` | `ui` | `recursor` | `proxy`,\n    useInternal = false\n): string => {\n    if (useInternal) {\n        if (endpointType === `api`) return `http://pektin-api`;\n        if (endpointType === `vault`) return `http://pektin-vault`;\n        if (endpointType === `ui`) return `http://pektin-ui`;\n        if (endpointType === `recursor`) return `http://pektin-recursor`;\n    }\n    let domain = ``;\n\n    if (endpointType === `proxy`) {\n        domain = concatDomain(c.reverseProxy.external.domain, c.reverseProxy.external.subDomain);\n    } else {\n        domain = concatDomain(c.services[endpointType].domain, c.services[endpointType].subDomain);\n    }\n    const protocol = c.reverseProxy.tls ? `https` : `http`;\n    let host = ``;\n    if (c.reverseProxy.routing === `local`) {\n        host = concatDomain(`localhost`, domain);\n    } else if (c.reverseProxy.routing === `minikube`) {\n        host = concatDomain(`minikube`, domain);\n    } else if (c.reverseProxy.routing === `domain`) {\n        host = domain;\n    }\n\n    return `${protocol}://${host}`;\n};\n")),(0,o.kt)("h3",{id:"get-value-from-vault"},"Get Value from Vault"),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The ",(0,o.kt)("strong",{parentName:"p"},"fetch")," function refers to the javascript fetch ",(0,o.kt)("em",{parentName:"p"},"HTTP client"),"."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// obtain the vault token by sending username and password to the vault endpoint\nexport const vaultLoginUserpass = async (\n    vaultEndpoint: string,\n    vaultUsername: string,\n    vaultPassword: string\n): Promise<string> => {\n    const res = await fetch(`${vaultEndpoint}/v1/auth/userpass/login/${vaultUsername}`, {\n        method: `POST`,\n        body: JSON.stringify({\n            password: vaultPassword\n        })\n    }).catch(e => {\n        throw Error(`Couldn't fetch: ` + e);\n    });\n\n    // try to parse the http response body as JSON\n    const json = await res.json().catch(e => {\n        throw Error(`Couldn't parse JSON response: ` + e);\n    });\n\n    return json.auth.client_token;\n};\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// get value for a key from vault\nexport const getVaultValue = async (\n    endpoint: string,\n    token: string,\n    key: string,\n    kvEngine: string\n) => {\n    const res = await fetch(`${endpoint}/v1/${kvEngine}/data/${key}`, {\n        headers: {\n            \"X-Vault-Token\": token\n        }\n    }).catch(e => {\n        throw Error(`Couldn't fetch: ` + e);\n    });\n\n    const json = await res.json().catch(e => {\n        throw Error(`Couldn't parse JSON response: ` + e);\n    });\n\n    return json?.data?.data;\n};\n")))}m.isMDXComponent=!0}}]);